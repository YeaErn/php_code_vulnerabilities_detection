state|code
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$sanitized = http_build_query($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = filter_var($tainted, FILTER_UNSAFE_RAW);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = hexdec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$legal = ["safe1", "safe2"];$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$sanitized = json_encode($tainted, JSON_PRETTY_PRINT, 512);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_URL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = rawurlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = strripos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(gettype($tainted) == "string"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = gzdeflate($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = strrpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_POST;$tainted = $tainted["t"];$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = mhash(MHASH_MD4, $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = md5($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$sanitized = http_build_query($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(settype($tainted, "float")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = md5($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_UNSAFE_RAW);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_URL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$sanitized = json_encode($tainted, JSON_PRETTY_PRINT, 512);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_POST;$tainted = $tainted["t"];if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_COOKIE;$tainted = $tainted["t"];if(is_long($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$sanitized = count($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$legal = ["safe1", "safe2"];$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$legal = ["safe1", "safe2"];$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = filter_var($tainted, FILTER_SANITIZE_URL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = mhash(MHASH_MD4, $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = rawurlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(settype($tainted, "float")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$legal = ["safe1", "safe2"];$tainted = $_COOKIE;$tainted = $tainted["t"];if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = getallheaders();$tainted = $tainted["t"];if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_GET;$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(gettype($tainted) == "string"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_long($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = mhash(MHASH_MD4, $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$sanitized = json_encode($tainted, JSON_PRETTY_PRINT, 512);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_GET;$tainted = $tainted["t"];if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = mhash(MHASH_MD4, $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_URL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = md5($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = gzdeflate($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = strrpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$sanitized = json_encode($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = strrpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = hexdec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_UNSAFE_RAW);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = strrpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(is_long($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_POST;$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = strrpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(settype($tainted, "float")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = strripos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = md5($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_URL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$legal = ["safe1", "safe2"];$tainted = apache_request_headers();$tainted = $tainted["t"];if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_POST;$sanitized = json_encode($tainted, JSON_PRETTY_PRINT, 512);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = hexdec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = mhash(MHASH_MD4, $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = hexdec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$sanitized = json_encode($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = apache_request_headers();$tainted = $tainted["t"];if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_POST;$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$legal = ["safe1", "safe2"];$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$sanitized = http_build_query($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$sanitized = json_encode($tainted, JSON_PRETTY_PRINT, 512);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(is_long($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = gzdeflate($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_COOKIE;$tainted = $tainted["t"];if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(gettype($tainted) == "string"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_COOKIE;$tainted = $tainted["t"];parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$sanitized = json_encode($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$sanitized = json_encode($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_UNSAFE_RAW);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];$sanitized = md5($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$sanitized = http_build_query($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_POST;$sanitized = json_encode($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = rawurlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = md5($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$legal = ["safe1", "safe2"];$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_UNSAFE_RAW);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(settype($tainted, "float")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_POST;$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$sanitized = json_encode($tainted, JSON_PRETTY_PRINT, 512);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$sanitized = json_encode($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];if(gettype($tainted) == "double"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$tainted = $tainted["t"];if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(settype($tainted, "float")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$sanitized = json_encode($tainted, JSON_PRETTY_PRINT, 512);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_POST;$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = strripos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = strripos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(is_long($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$sanitized = json_encode($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(gettype($tainted) == "double"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = mhash(MHASH_MD4, $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];if(is_long($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_POST;$tainted = $tainted["t"];$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$legal = ["safe1", "safe2"];$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = strrpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = getallheaders();$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = strrpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_REQUEST;$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$sanitized = http_build_query($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = rawurlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$sanitized = json_encode($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$sanitized = json_encode($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = gzdeflate($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$sanitized = http_build_query($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(gettype($tainted) == "string"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(gettype($tainted) == "string"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$legal = ["safe1", "safe2"];$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$sanitized = json_encode($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = gzdeflate($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = mhash(MHASH_MD4, $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_POST;$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_COOKIE;$tainted = $tainted["t"];if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = rawurlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(gettype($tainted) == "double"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_POST;$tainted = $tainted["t"];if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = mhash(MHASH_MD4, $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = hexdec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = gzdeflate($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(settype($tainted, "string")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(settype($tainted, "string")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = rawurlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = gzdeflate($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_REQUEST;$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = rawurlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = getallheaders();$tainted = $tainted["t"];if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(gettype($tainted) == "string"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(gettype($tainted) == "double"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = strripos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_GET;$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(gettype($tainted) == "string"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_POST;$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = rawurlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = strripos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = hexdec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_UNSAFE_RAW);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$sanitized = http_build_query($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_UNSAFE_RAW);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(gettype($tainted) == "double"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = str_word_count($tainted, 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$tainted = $tainted["t"];if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = md5($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$legal = ["safe1", "safe2"];$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(settype($tainted, "string")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = getallheaders();$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_POST;$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(gettype($tainted) == "string"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$legal = ["safe1", "safe2"];$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(settype($tainted, "string")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = rawurlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = strripos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_POST;$tainted = $tainted["t"];if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$sanitized = json_encode($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = mhash(MHASH_MD4, $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$sanitized = count($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = strrpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];if(settype($tainted, "string")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_URL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_URL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$sanitized = json_encode($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = md5($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = strrpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = gzdeflate($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = strrpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$legal = ["safe1", "safe2"];$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(gettype($tainted) == "string"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(gettype($tainted) == "double"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];if(settype($tainted, "string")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = gzdeflate($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_URL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$sanitized = count($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = str_replace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_UNSAFE_RAW);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = $pdo->quote($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_REQUEST;$sanitized = count($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = strripos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = hexdec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_GET;$tainted = $tainted["t"];if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = filter_var($tainted, FILTER_UNSAFE_RAW);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = getallheaders();$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$sanitized = count($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_REQUEST;$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$sanitized = json_encode($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = strripos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$sanitized = http_build_query($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_COOKIE;$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = getallheaders();$tainted = $tainted["t"];if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(gettype($tainted) == "string"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = md5($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$sanitized = json_encode($tainted, JSON_PRETTY_PRINT, 512);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(ctype_digit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = gzdeflate($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(settype($tainted, "string")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(settype($tainted, "float")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = gzdeflate($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(settype($tainted, "float")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_POST;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(settype($tainted, "string")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(gettype($tainted) == "double"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$sanitized = json_encode($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(settype($tainted, "string")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(gettype($tainted) == "double"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$legal = ["safe1", "safe2"];$tainted = apache_request_headers();$tainted = $tainted["t"];if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_POST;$tainted = $tainted["t"];if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_URL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = ord($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$sanitized = http_build_query($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = str_replace("'", "''", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$legal = ["safe1", "safe2"];$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = str_replace(" ", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(settype($tainted, "string")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_POST;$tainted = $tainted["t"];$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(is_bool($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$sanitized = http_build_query($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$sanitized = http_build_query($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$sanitized = json_encode($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = doubleval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$legal = ["safe1", "safe2"];$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->multi_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_COOKIE;$sanitized = json_encode($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$sanitized = json_encode($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(gettype($tainted) == "string"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = substr_count($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(is_integer($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = soundex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$sanitized = json_encode($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = md5($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(settype($tainted, "float")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];if(preg_match("/[0-9]/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = mhash(MHASH_MD4, $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = base64_encode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = metaphone($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_COOKIE;$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];parse_str($tainted, $sanitized);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = htmlspecialchars($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = $tainted+= 0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = hexdec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = hash("ripemd160", $tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = strtr($tainted, "'", " ");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = crypt($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlspecialchars($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_shuffle($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = getallheaders();$tainted = $tainted["t"];if(gettype($tainted) == "double"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$sanitized = json_encode($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_REQUEST;$tainted = $tainted["t"];if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = $_COOKIE;$tainted = $tainted["t"];if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = md5($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$legal = ["safe1", "safe2"];$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = htmlentities($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = strip_tags($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_ADD_SLASHES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_REQUEST;$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);if(preg_match("/^[A-Za-z]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = (int)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = (string)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$legal = ["safe1", "safe2"];$tainted = getallheaders();$tainted = $tainted["t"];if(in_array($tainted, $legal, true)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = strstr($tainted, "1");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);$sanitized = $tainted+= 0.0;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(is_numeric($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = getallheaders();$tainted = $tainted["t"];if(is_int($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = getallheaders();$tainted = $tainted["t"];$sanitized = rawurlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];if(ctype_alpha($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = getallheaders();$tainted = $tainted["t"];if(is_string($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $result = pg_query($db, $context);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  pg_send_query($db, $context);  $result = pg_get_result($db);  while(($row = pg_fetch_row($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(settype($tainted, "string")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = $pdo->quote($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_INT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(ctype_xdigit($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$sanitized = sizeof($tainted, COUNT_NORMAL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(settype($tainted, "bool")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = hash_hmac("md5", $tainted, "salt");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = strripos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = str_ireplace("'", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = pg_query($db, $context);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = strpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = gzencode($tainted, 9);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$sanitized = json_encode($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$tainted = $tainted["t"];$sanitized = $tainted;$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = count_chars($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_NUMBER_FLOAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = hexdec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = crc32($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(gettype($tainted) == "integer"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_EMAIL);$sanitized = ($tainted + 0.0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = ($tainted + 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$sanitized = json_encode($tainted, ENT_NOQUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(is_long($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = sscanf($tainted, "foo %d");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $result = sqlsrv_query($db, $context);  while(($row = sqlsrv_fetch_object($result)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = html_entity_decode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_URL]);$tainted = $tainted["t"];$sanitized = sscanf($tainted, "foo %s");$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = getallheaders();$tainted = $tainted["t"];if(preg_match("/^[0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];if(is_real($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_real_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = urlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = floatval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_prepare($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}$result = db2_execute($stmt, []);while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = rawurlencode($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = addslashes($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = bindec($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = apache_request_headers();$tainted = $tainted["t"];if(ctype_alnum($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $pdo->query($context);  foreach ($results as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = zlib_encode($tainted, ZLIB_ENCODING_DEFLATE);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(is_long($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = $pdo->prepare($context);  $results = $stmt->execute([]);  foreach ($stmt->fetchAll() as $row){    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];$sanitized = htmlentities($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_UNSAFE_RAW);$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(settype($tainted, "int")){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $db->real_query($context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = password_hash($tainted, PASSWORD_DEFAULT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = strripos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_REQUEST;$sanitized = json_encode($tainted, JSON_PRETTY_PRINT, 512);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_POST;$tainted = $tainted["t"];$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = substr_replace($tainted, "bob", 0);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = $_GET;$tainted = $tainted["t"];if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = htmlentities($tainted, ENT_QUOTES);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$result = sqlsrv_query($db, $context);while(($row = sqlsrv_fetch_object($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = bin2hex($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = db2_exec($db, $context);if($stmt == false){  die(db2_stmt_errormsg());}while(($row = db2_fetch_array($stmt))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_URL);$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_COOKIE;$tainted = $tainted["t"];if(preg_match_all("/^[A-Za-z0-9]*$/", $tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = mysqli_prepare($db, $context);  mysqli_stmt_execute($stmt);  $results = mysqli_stmt_get_result($stmt);  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = (double)($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = $_GET;$tainted = $tainted["t"];if(ctype_cntrl($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");  $stmt = db2_prepare($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  $result = db2_execute($stmt, []);  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = $_COOKIE;$tainted = $tainted["t"];$sanitized = sha1($tainted, false);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_GET;$tainted = $tainted["t"];$sanitized = addcslashes($tainted, ";:'\"");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = strspn($tainted, "needle)");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = mysqli_prepare($db, $context);mysqli_stmt_execute($stmt);$results = mysqli_stmt_get_result($stmt);while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$dsn = "DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;";$db = db2_connect($dsn, "", "");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_FLOAT]);$tainted = $tainted["t"];if(gettype($tainted) == "boolean"){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = db2_exec($db, $context);  if($stmt == false)  {    die(db2_stmt_errormsg());  }  while(($row = db2_fetch_array($stmt)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = str_getcsv($tainted);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");$stmt = sqlsrv_prepare($db, $context);$result = sqlsrv_execute($stmt);while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = $_POST;$tainted = $tainted["t"];$sanitized = (($tainted == "DESC") ? "DESC" : "ASC");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $db->query($context);while(($row = $results->fetchArray())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_FULL_SPECIAL_CHARS]);$tainted = $tainted["t"];if(fnmatch("*", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_FLOAT);$sanitized = intval($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$results = $pdo->query($context);foreach ($results as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_EMAIL]);$tainted = $tainted["t"];$sanitized = str_ireplace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_SPECIAL_CHARS);$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->multi_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_word_count($tainted, 1);$sanitized = implode($sanitized, "_");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_ADD_SLASHES);if(is_double($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");  mysqli_multi_query($db, $context);  $results = $db->use_result();  while(($row = $results->fetch_row()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = pg_pconnect("host=postgres-server port=5432 user=postgres password=postgres123 dbname=myDB");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];$sanitized = strrpos($tainted, "needle");$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");pg_send_query($db, $context);$result = pg_get_result($db);while(($row = pg_fetch_row($result))){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$pdo = new PDO("mysql:host=mysql;port=3306;dbname=myDB", "username", "password");$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_FULL_SPECIAL_CHARS);$sanitized = preg_replace("/'/", "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$stmt = $pdo->prepare($context);$results = $stmt->execute([]);foreach ($stmt->fetchAll() as $row){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input(INPUT_GET, "t", FILTER_SANITIZE_NUMBER_INT);$sanitized = htmlentities($tainted, ENT_COMPAT);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_ADD_SLASHES]);$tainted = $tainted["t"];$sanitized = gzcompress($tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Good|<?php$info = ["Database" => "myDB", "UID" => "SA", "PWD" => "Msql12345678!"];$db = sqlsrv_connect("mssql", $info);if($db == false){  die(print_r(sqlsrv_errors(), true));}$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_UNSAFE_RAW]);$tainted = $tainted["t"];if(fnmatch("whitelisting", $tainted, 0)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $stmt = sqlsrv_prepare($db, $context);  $result = sqlsrv_execute($stmt);  while(($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)))  {    echo(htmlentities(print_r($row, true)));  }}?>
Good|<?php$db = new SQLite3("/var/www/db/database.db");$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_NUMBER_INT]);$tainted = $tainted["t"];if(is_float($tainted)){  $sanitized = $tainted;  $dataflow = $sanitized;  $context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");  $results = $db->query($context);  while(($row = $results->fetchArray()))  {    echo(htmlentities(print_r($row, true)));  }}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = $_GET;$tainted = $tainted["t"];$sanitized = substr_replace($tainted, "bob", 50);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password =\"" . $dataflow) . "\";");mysqli_real_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = apache_request_headers();$tainted = $tainted["t"];$sanitized = filter_var($tainted, FILTER_UNSAFE_RAW);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE password ='" . $dataflow) . "';");$db->real_query($context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
Bad|<?php$servername = "mysql";$username = "username";$password = "password";$dbName = "myDB";$db = new mysqli($servername, $username, $password, $dbName);$tainted = filter_input_array(INPUT_GET, ["t" => FILTER_SANITIZE_SPECIAL_CHARS]);$tainted = $tainted["t"];$sanitized = str_replace(["\"", "'", "<", ">"], "", $tainted);$dataflow = $sanitized;$context = (("SELECT * FROM users WHERE pin =" . $dataflow) . ";");mysqli_multi_query($db, $context);$results = $db->use_result();while(($row = $results->fetch_row())){  echo(htmlentities(print_r($row, true)));}?>
